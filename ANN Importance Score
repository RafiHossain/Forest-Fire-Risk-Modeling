import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score
from sklearn.inspection import permutation_importance

# Load the dataset
df = pd.read_csv('Dataset.csv')

# Extract the features and target variable
X = df[['aspects', 'LAI', 'LULC_21', 'temperatur', 'NDVI', 'NDWI','river','road','settlement','Slope','DEM','rainfall','Curvature','Roughness','FCR']]
y = df['Type']

# Split the data into train and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Initialize the ANN classifier
clf = MLPClassifier(hidden_layer_sizes=(100, 50), max_iter=5000, random_state=42)

# Train the classifier
clf.fit(X_train, y_train)

# Predict on test data
y_pred = clf.predict(X_test)

# Calculate importance scores using permutation feature importance
result = permutation_importance(clf, X_test, y_test, n_repeats=100, random_state=42, n_jobs=-1)

# Get feature importance
importance = result.importances_mean

# Print feature importance scores
for i, feature in enumerate(X.columns):
    print(f'{feature}: {importance[i]}')
